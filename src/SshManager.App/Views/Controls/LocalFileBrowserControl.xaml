<controls:FileBrowserControlBase x:Class="SshManager.App.Views.Controls.LocalFileBrowserControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
             xmlns:converters="clr-namespace:SshManager.App.Converters"
             xmlns:controls="clr-namespace:SshManager.App.Views.Controls"
             xmlns:viewmodels="clr-namespace:SshManager.App.ViewModels"
             mc:Ignorable="d"
             d:DesignHeight="400" d:DesignWidth="350"
             TextOptions.TextFormattingMode="Display"
             TextOptions.TextRenderingMode="ClearType"
             UseLayoutRounding="True"
             SnapsToDevicePixels="True">

    <controls:FileBrowserControlBase.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter" />
        <converters:SimpleFileIconConverter x:Key="FileIconConverter" />
        <converters:ShellFileIconConverter x:Key="ShellFileIconConverter" />
        <converters:StringToVisibilityConverter x:Key="StringToVisibilityConverter" />
        <converters:FileItemColorConverter x:Key="FileItemColorConverter" />
        <converters:SortIndicatorVisibilityConverter x:Key="SortIndicatorVisibilityConverter" />
        <converters:SortDirectionToSymbolConverter x:Key="SortDirectionToSymbolConverter" />

        <!-- GridView Column Header Style for dark theme with resizable columns -->
        <Style TargetType="GridViewColumnHeader">
            <Setter Property="Background" Value="#1A1A1A" />
            <Setter Property="Foreground" Value="#E0E0E0" />
            <Setter Property="BorderBrush" Value="#333333" />
            <Setter Property="BorderThickness" Value="0,0,0,1" />
            <Setter Property="Padding" Value="6,4" />
            <Setter Property="HorizontalContentAlignment" Value="Left" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="GridViewColumnHeader">
                        <Grid>
                            <Border x:Name="HeaderBorder"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    Padding="{TemplateBinding Padding}">
                                <ContentPresenter x:Name="HeaderContent"
                                                  HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                  VerticalAlignment="Center"
                                                  RecognizesAccessKey="True"
                                                  SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                            </Border>
                            <!-- Resize Gripper -->
                            <Thumb x:Name="PART_HeaderGripper"
                                   HorizontalAlignment="Right"
                                   Width="6"
                                   Margin="0,0,-3,0"
                                   Cursor="SizeWE"
                                   Background="Transparent">
                                <Thumb.Template>
                                    <ControlTemplate TargetType="Thumb">
                                        <Border Background="Transparent" Width="6">
                                            <Border Width="1"
                                                    Background="#404040"
                                                    HorizontalAlignment="Center"
                                                    Opacity="0"
                                                    x:Name="GripperLine" />
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="GripperLine" Property="Opacity" Value="1" />
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Thumb.Template>
                            </Thumb>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="HeaderBorder" Property="Background" Value="#252525" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </controls:FileBrowserControlBase.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- Header with icon and accent underline -->
        <Border Grid.Row="0"
                Background="{ui:ThemeResource ControlFillColorDefaultBrush}"
                CornerRadius="6,6,0,0"
                Margin="4,4,4,0"
                Padding="10,6">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <ui:SymbolIcon Symbol="Desktop24"
                                   FontSize="16"
                                   Foreground="{ui:ThemeResource AccentTextFillColorPrimaryBrush}"
                                   Margin="0,0,8,0" />
                    <TextBlock Text="Local"
                               FontWeight="SemiBold"
                               FontSize="13"
                               VerticalAlignment="Center" />
                </StackPanel>
                <!-- Accent underline -->
                <Border Grid.ColumnSpan="2"
                        Height="2"
                        VerticalAlignment="Bottom"
                        Margin="-10,-6,-10,-6"
                        Background="{ui:ThemeResource AccentTextFillColorPrimaryBrush}"
                        Opacity="0.5" />
            </Grid>
        </Border>

        <!-- Navigation Bar -->
        <Grid Grid.Row="1" Margin="4,0,4,4">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <!-- Back Button -->
            <ui:Button Grid.Column="0"
                       Icon="{ui:SymbolIcon ArrowLeft24}"
                       ToolTip="Back (Backspace)"
                       Command="{Binding GoBackCommand}"
                       IsEnabled="{Binding CanGoBack}"
                       Padding="6"
                       Margin="0,0,2,0" />

            <!-- Up Button -->
            <ui:Button Grid.Column="1"
                       Icon="{ui:SymbolIcon ArrowUp24}"
                       ToolTip="Parent Directory (Backspace)"
                       Command="{Binding GoUpCommand}"
                       IsEnabled="{Binding CanGoUp}"
                       Padding="6"
                       Margin="0,0,2,0" />

            <!-- Refresh Button -->
            <ui:Button Grid.Column="2"
                       Icon="{ui:SymbolIcon ArrowSync24}"
                       ToolTip="Refresh (F5)"
                       Command="{Binding RefreshCommand}"
                       Padding="6"
                       Margin="0,0,4,0" />

            <!-- Breadcrumb Path with Copy Button -->
            <Border Grid.Column="3"
                    Background="{ui:ThemeResource ControlFillColorDefaultBrush}"
                    CornerRadius="4"
                    Padding="4,2">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <ScrollViewer Grid.Column="0"
                                  HorizontalScrollBarVisibility="Auto"
                                  VerticalScrollBarVisibility="Disabled">
                        <ItemsControl ItemsSource="{Binding Breadcrumbs}">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <StackPanel Orientation="Horizontal" />
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal">
                                        <ui:Button Content="{Binding Name}"
                                                   Command="{Binding DataContext.NavigateToBreadcrumbCommand, RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                                                   CommandParameter="{Binding}"
                                                   Padding="6,3"
                                                   Background="Transparent"
                                                   FontSize="12"
                                                   Cursor="Hand">
                                            <ui:Button.Style>
                                                <Style TargetType="ui:Button" BasedOn="{StaticResource {x:Type ui:Button}}">
                                                    <Setter Property="Opacity" Value="0.9" />
                                                    <Style.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter Property="Opacity" Value="1" />
                                                            <Setter Property="Background" Value="{ui:ThemeResource ControlFillColorSecondaryBrush}" />
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </ui:Button.Style>
                                        </ui:Button>
                                        <ui:SymbolIcon Symbol="ChevronRight20"
                                                       FontSize="10"
                                                       VerticalAlignment="Center"
                                                       Opacity="0.5"
                                                       Margin="2,0" />
                                    </StackPanel>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                    <!-- Copy Path Button -->
                    <ui:Button Grid.Column="1"
                               Icon="{ui:SymbolIcon Copy16}"
                               ToolTip="Copy Path to Clipboard"
                               Click="CopyPath_Click"
                               Padding="4"
                               Margin="4,0,0,0"
                               Background="Transparent"
                               Opacity="0.7"
                               Cursor="Hand">
                        <ui:Button.Style>
                            <Style TargetType="ui:Button" BasedOn="{StaticResource {x:Type ui:Button}}">
                                <Setter Property="Opacity" Value="0.7" />
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Opacity" Value="1" />
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </ui:Button.Style>
                    </ui:Button>
                </Grid>
            </Border>
        </Grid>

        <!-- Quick Access Drives -->
        <Border Grid.Row="2"
                Background="{ui:ThemeResource ControlFillColorDefaultBrush}"
                CornerRadius="4"
                Margin="4,4,4,4"
                Padding="4">
            <ScrollViewer HorizontalScrollBarVisibility="Auto"
                          VerticalScrollBarVisibility="Disabled">
                <ItemsControl ItemsSource="{Binding Drives}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel Orientation="Horizontal" />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <ui:Button Command="{Binding DataContext.NavigateToDriveCommand, RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                                       CommandParameter="{Binding}"
                                       Padding="8,5"
                                       Margin="0,0,4,0"
                                       Background="{ui:ThemeResource ControlFillColorSecondaryBrush}"
                                       CornerRadius="4"
                                       Cursor="Hand">
                                <ui:Button.ToolTip>
                                    <ToolTip>
                                        <StackPanel>
                                            <TextBlock Text="{Binding DisplayName}" FontWeight="SemiBold" />
                                            <TextBlock Opacity="0.7">
                                                <TextBlock.Text>
                                                    <MultiBinding StringFormat="{}{0:N0} GB free of {1:N0} GB">
                                                        <Binding Path="FreeSpace" Converter="{converters:BytesToGigabytesConverter}" />
                                                        <Binding Path="TotalSize" Converter="{converters:BytesToGigabytesConverter}" />
                                                    </MultiBinding>
                                                </TextBlock.Text>
                                            </TextBlock>
                                        </StackPanel>
                                    </ToolTip>
                                </ui:Button.ToolTip>
                                <StackPanel Orientation="Horizontal">
                                    <ui:SymbolIcon Symbol="HardDrive20"
                                                   FontSize="14"
                                                   Margin="0,0,6,0"
                                                   Foreground="{ui:ThemeResource AccentTextFillColorPrimaryBrush}" />
                                    <TextBlock Text="{Binding Name}"
                                               FontSize="11"
                                               VerticalAlignment="Center" />
                                </StackPanel>
                            </ui:Button>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>
        </Border>

        <!-- Filter Box -->
        <Grid Grid.Row="3" Margin="4,0,4,4">
            <ui:TextBox x:Name="FilterTextBox"
                        PlaceholderText="Filter files..."
                        Text="{Binding FilterText, UpdateSourceTrigger=PropertyChanged}"
                        Icon="{ui:SymbolIcon Search16}"
                        IconPlacement="Left"
                        ClearButtonEnabled="True"
                        FontSize="12"
                        Padding="8,4">
                <ui:TextBox.InputBindings>
                    <KeyBinding Key="Escape" Command="{Binding ClearFilterCommand}" />
                </ui:TextBox.InputBindings>
            </ui:TextBox>
        </Grid>

        <!-- File List -->
        <Border Grid.Row="4"
                Background="#1A1A1A"
                CornerRadius="6"
                Margin="4,0,4,4">
            <Grid>
                <!-- Loading Overlay -->
                <Border Background="#1A1A1A"
                        Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibilityConverter}}"
                        CornerRadius="6"
                        Panel.ZIndex="1">
                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                        <ui:ProgressRing IsIndeterminate="True" Width="32" Height="32" />
                        <TextBlock Text="Loading..." Margin="0,8,0,0" Foreground="#B0B0B0" />
                    </StackPanel>
                </Border>

                <!-- Error Message -->
                <Border Background="#1A1A1A"
                        Visibility="{Binding ErrorMessage, Converter={StaticResource StringToVisibilityConverter}}"
                        CornerRadius="6"
                        Panel.ZIndex="1">
                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center" Margin="16">
                        <ui:SymbolIcon Symbol="ErrorCircle24" FontSize="32" Foreground="#E74C3C" />
                        <TextBlock Text="{Binding ErrorMessage}"
                                   TextWrapping="Wrap"
                                   TextAlignment="Center"
                                   Margin="0,8,0,0"
                                   Foreground="#D0D0D0" />
                    </StackPanel>
                </Border>

                <!-- File ListView -->
                <ListView x:Name="FileListViewControl"
                          ItemsSource="{Binding Items}"
                          SelectedItem="{Binding SelectedItem, Mode=TwoWay}"
                          SelectionMode="Extended"
                          Background="Transparent"
                          BorderThickness="0"
                          ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                          VirtualizingPanel.IsVirtualizing="True"
                          VirtualizingPanel.VirtualizationMode="Recycling"
                          MouseDoubleClick="FileListView_MouseDoubleClick"
                          PreviewKeyDown="FileListView_PreviewKeyDown"
                          PreviewMouseLeftButtonDown="FileListView_PreviewMouseLeftButtonDown"
                          PreviewMouseMove="FileListView_PreviewMouseMove"
                          SelectionChanged="FileListView_SelectionChanged"
                          AllowDrop="True"
                          Drop="FileListView_Drop"
                          DragOver="FileListView_DragOver"
                          DragEnter="FileListView_DragEnter"
                          DragLeave="FileListView_DragLeave"
                          GiveFeedback="FileListView_GiveFeedback">
                    <ListView.ContextMenu>
                        <ContextMenu DataContext="{Binding PlacementTarget.DataContext, RelativeSource={RelativeSource Self}}">
                            <ui:MenuItem Header="Open"
                                         Icon="{ui:SymbolIcon FolderOpen24}"
                                         Click="ContextMenu_Open_Click"
                                         InputGestureText="Enter" />
                            <ui:MenuItem Header="Edit"
                                         Icon="{ui:SymbolIcon Edit24}"
                                         Click="ContextMenu_Edit_Click"
                                         Visibility="{Binding SelectedItem.IsEditable, Converter={StaticResource BoolToVisibilityConverter}}" />
                            <Separator />
                            <ui:MenuItem Header="Upload"
                                         Icon="{ui:SymbolIcon ArrowUpload24}"
                                         Click="ContextMenu_Upload_Click"
                                         InputGestureText="Ctrl+U" />
                            <Separator />
                            <ui:MenuItem Header="Copy Path"
                                         Icon="{ui:SymbolIcon Copy24}"
                                         Click="ContextMenu_CopyPath_Click"
                                         InputGestureText="Ctrl+Shift+C" />
                            <Separator />
                            <ui:MenuItem Header="Rename"
                                         Icon="{ui:SymbolIcon Rename24}"
                                         Click="ContextMenu_Rename_Click"
                                         InputGestureText="F2" />
                            <ui:MenuItem Header="Delete"
                                         Icon="{ui:SymbolIcon Delete24}"
                                         Click="ContextMenu_Delete_Click"
                                         InputGestureText="Del" />
                        </ContextMenu>
                    </ListView.ContextMenu>
                    <ListView.View>
                        <GridView>
                            <GridViewColumn Width="180">
                                <GridViewColumn.Header>
                                    <ui:Button Background="Transparent"
                                               Padding="0"
                                               Margin="-6,-4"
                                               BorderThickness="0"
                                               Command="{Binding DataContext.SortByCommand, RelativeSource={RelativeSource AncestorType=ListView}}"
                                               CommandParameter="{x:Static viewmodels:FileSortColumn.Name}"
                                               Cursor="Hand">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="Name" FontWeight="SemiBold" VerticalAlignment="Center" Foreground="#E0E0E0" />
                                            <ui:SymbolIcon FontSize="12"
                                                           Margin="4,0,0,0"
                                                           VerticalAlignment="Center"
                                                           Symbol="{Binding DataContext.SortDirection, RelativeSource={RelativeSource AncestorType=ListView}, Converter={StaticResource SortDirectionToSymbolConverter}}">
                                                <ui:SymbolIcon.Visibility>
                                                    <MultiBinding Converter="{StaticResource SortIndicatorVisibilityConverter}" ConverterParameter="Name">
                                                        <Binding Path="DataContext.SortColumn" RelativeSource="{RelativeSource AncestorType=ListView}" />
                                                        <Binding Path="DataContext.SortDirection" RelativeSource="{RelativeSource AncestorType=ListView}" />
                                                    </MultiBinding>
                                                </ui:SymbolIcon.Visibility>
                                            </ui:SymbolIcon>
                                        </StackPanel>
                                    </ui:Button>
                                </GridViewColumn.Header>
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <Image Source="{Binding Converter={StaticResource ShellFileIconConverter}}"
                                                   Width="16"
                                                   Height="16"
                                                   Margin="0,0,6,0"
                                                   RenderOptions.BitmapScalingMode="HighQuality" />
                                            <TextBlock Text="{Binding Name}"
                                                       TextTrimming="CharacterEllipsis"
                                                       VerticalAlignment="Center"
                                                       Foreground="{Binding Converter={StaticResource FileItemColorConverter}}" />
                                        </StackPanel>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>
                            <GridViewColumn Width="70">
                                <GridViewColumn.Header>
                                    <ui:Button Background="Transparent"
                                               Padding="0"
                                               Margin="-6,-4"
                                               BorderThickness="0"
                                               Command="{Binding DataContext.SortByCommand, RelativeSource={RelativeSource AncestorType=ListView}}"
                                               CommandParameter="{x:Static viewmodels:FileSortColumn.Size}"
                                               Cursor="Hand">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="Size" FontWeight="SemiBold" VerticalAlignment="Center" Foreground="#E0E0E0" />
                                            <ui:SymbolIcon FontSize="12"
                                                           Margin="4,0,0,0"
                                                           VerticalAlignment="Center"
                                                           Symbol="{Binding DataContext.SortDirection, RelativeSource={RelativeSource AncestorType=ListView}, Converter={StaticResource SortDirectionToSymbolConverter}}">
                                                <ui:SymbolIcon.Visibility>
                                                    <MultiBinding Converter="{StaticResource SortIndicatorVisibilityConverter}" ConverterParameter="Size">
                                                        <Binding Path="DataContext.SortColumn" RelativeSource="{RelativeSource AncestorType=ListView}" />
                                                        <Binding Path="DataContext.SortDirection" RelativeSource="{RelativeSource AncestorType=ListView}" />
                                                    </MultiBinding>
                                                </ui:SymbolIcon.Visibility>
                                            </ui:SymbolIcon>
                                        </StackPanel>
                                    </ui:Button>
                                </GridViewColumn.Header>
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding SizeDisplay}"
                                                   FontSize="12"
                                                   TextAlignment="Right"
                                                   HorizontalAlignment="Right"
                                                   Foreground="#E0E0E0" />
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>
                            <GridViewColumn Width="110">
                                <GridViewColumn.Header>
                                    <ui:Button Background="Transparent"
                                               Padding="0"
                                               Margin="-6,-4"
                                               BorderThickness="0"
                                               Command="{Binding DataContext.SortByCommand, RelativeSource={RelativeSource AncestorType=ListView}}"
                                               CommandParameter="{x:Static viewmodels:FileSortColumn.Modified}"
                                               Cursor="Hand">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="Modified" FontWeight="SemiBold" VerticalAlignment="Center" Foreground="#E0E0E0" />
                                            <ui:SymbolIcon FontSize="12"
                                                           Margin="4,0,0,0"
                                                           VerticalAlignment="Center"
                                                           Symbol="{Binding DataContext.SortDirection, RelativeSource={RelativeSource AncestorType=ListView}, Converter={StaticResource SortDirectionToSymbolConverter}}">
                                                <ui:SymbolIcon.Visibility>
                                                    <MultiBinding Converter="{StaticResource SortIndicatorVisibilityConverter}" ConverterParameter="Modified">
                                                        <Binding Path="DataContext.SortColumn" RelativeSource="{RelativeSource AncestorType=ListView}" />
                                                        <Binding Path="DataContext.SortDirection" RelativeSource="{RelativeSource AncestorType=ListView}" />
                                                    </MultiBinding>
                                                </ui:SymbolIcon.Visibility>
                                            </ui:SymbolIcon>
                                        </StackPanel>
                                    </ui:Button>
                                </GridViewColumn.Header>
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding ModifiedDisplay}"
                                                   ToolTip="{Binding ModifiedFullTimestamp}"
                                                   FontSize="12"
                                                   Foreground="#E0E0E0" />
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>
                        </GridView>
                    </ListView.View>
                    <ListView.ItemContainerStyle>
                        <Style TargetType="ListViewItem">
                            <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                            <Setter Property="Padding" Value="4,3" />
                            <Setter Property="Foreground" Value="#E0E0E0" />
                            <Setter Property="Background" Value="Transparent" />
                            <Setter Property="BorderThickness" Value="1" />
                            <Setter Property="BorderBrush" Value="Transparent" />
                            <Setter Property="Margin" Value="0" />
                            <Setter Property="FocusVisualStyle" Value="{x:Null}" />
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="#3D3D3D" />
                                    <Setter Property="Foreground" Value="White" />
                                </Trigger>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter Property="Background" Value="#0078D4" />
                                    <Setter Property="Foreground" Value="White" />
                                </Trigger>
                                <Trigger Property="IsKeyboardFocused" Value="True">
                                    <Setter Property="BorderBrush" Value="#0078D4" />
                                </Trigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IsSelected" Value="True" />
                                        <Condition Property="IsMouseOver" Value="True" />
                                    </MultiTrigger.Conditions>
                                    <Setter Property="Background" Value="#1084D8" />
                                    <Setter Property="Foreground" Value="White" />
                                </MultiTrigger>
                                <MultiTrigger>
                                    <MultiTrigger.Conditions>
                                        <Condition Property="IsSelected" Value="True" />
                                        <Condition Property="IsKeyboardFocused" Value="True" />
                                    </MultiTrigger.Conditions>
                                    <Setter Property="BorderBrush" Value="White" />
                                </MultiTrigger>
                            </Style.Triggers>
                        </Style>
                    </ListView.ItemContainerStyle>
                </ListView>
            </Grid>
        </Border>
    </Grid>
</controls:FileBrowserControlBase>
